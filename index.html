<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPS Serviceability System</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .lucide { display: inline-block; vertical-align: middle; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple icon components
        const Search = ({size = 20, className = ""}) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
        );

        const AlertCircle = ({size = 20, className = ""}) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        const CheckCircle = ({size = 20, className = ""}) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
        );

        const Download = ({size = 20, className = ""}) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        );

        const Settings = ({size = 20, className = ""}) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m5.2-13.2 4.2 4.2m-13.4 0-4.2-4.2m18.4 9-4.2-4.2m0 13.4 4.2 4.2m-18.4 0 4.2-4.2"></path>
            </svg>
        );

        const Plane = ({size = 20, className = ""}) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z"></path>
            </svg>
        );

        function EPSUpdateSystem() {
            const [components, setComponents] = useState([]);
            const [loading, setLoading] = useState(true);
            const [searchTerm, setSearchTerm] = useState('');
            const [filter, setFilter] = useState('all');
            const [selectedComponent, setSelectedComponent] = useState(null);
            const [showUpdateForm, setShowUpdateForm] = useState(false);
            const [notification, setNotification] = useState('');
            const [updateData, setUpdateData] = useState({
                status: 'serviceable',
                aircraftNo: '',
                sentForRepair: '',
                expectedReturn: '',
                remarks: ''
            });

            const initialData = [
                { no: 1, epsSerial: '80379', initialCharge: '21.05.2024', status: 'unserviceable', aircraftNo: '', sentForRepair: '18/12/25', expectedReturn: '', remarks: 'U/S (AS/B/156/24) (AWD DMD 18/12/25)' },
                { no: 2, epsSerial: '80919', initialCharge: '17.09.2007', status: 'serviceable', aircraftNo: 'M50-21', sentForRepair: '', expectedReturn: '', remarks: 'Due 06/04/2026' },
                { no: 3, epsSerial: '80996', initialCharge: '20.10.2008', status: 'serviceable', aircraftNo: 'M50-16', sentForRepair: '', expectedReturn: '', remarks: 'Due 17/08/2026' },
                { no: 4, epsSerial: '81045', initialCharge: '24.05.2007', status: 'unserviceable', aircraftNo: '', sentForRepair: '28/10/24', expectedReturn: '', remarks: 'U/S (AS/B/171/24) (AWD DMD 28/10/24)' },
                { no: 5, epsSerial: '81046', initialCharge: '03.05.2008', status: 'serviceable', aircraftNo: 'M50-01', sentForRepair: '', expectedReturn: '', remarks: 'Due 11/11/2026' },
                { no: 6, epsSerial: '81262', initialCharge: '03.05.2024', status: 'unserviceable', aircraftNo: '', sentForRepair: '02/09/25', expectedReturn: '', remarks: 'U/S (AS/B/111/25) (AWD DMD 02/09/25)' },
                { no: 7, epsSerial: '81308', initialCharge: '12.09.2008', status: 'unserviceable', aircraftNo: '', sentForRepair: '13/06/25', expectedReturn: '', remarks: 'U/S (AS/B/055/25) (AWD DMD 13/06/25)' },
                { no: 8, epsSerial: '81322', initialCharge: '02.05.2014', status: 'unserviceable', aircraftNo: '', sentForRepair: '03/10/24', expectedReturn: '', remarks: 'Sent to Nilai (Loan) (15/08/25) (AS/B/164/24)' },
                { no: 9, epsSerial: '81688', initialCharge: '04.12.2008', status: 'unserviceable', aircraftNo: '', sentForRepair: '02/09/25', expectedReturn: '', remarks: 'U/S (AS/B/110/25) (AWD DMD 02/09/25)' },
                { no: 10, epsSerial: '81829', initialCharge: '08.08.2008', status: 'unserviceable', aircraftNo: '', sentForRepair: '02/09/25', expectedReturn: '', remarks: 'U/S (AS/B/112/25) (AWD DMD 02/09/25)' },
                { no: 11, epsSerial: '83204', initialCharge: '12.02.2015', status: 'unserviceable', aircraftNo: '', sentForRepair: '11/05/25', expectedReturn: '', remarks: 'U/S (AS/B/109/25) (AWD DMD 11/05/25)' },
                { no: 12, epsSerial: '83210', initialCharge: '03.05.2024', status: 'unserviceable', aircraftNo: '', sentForRepair: '24/11/25', expectedReturn: '', remarks: 'U/S (AS/B/148/25) (AWD DMD 24/11/25)' },
                { no: 13, epsSerial: '83218', initialCharge: '16.12.2015', status: 'serviceable', aircraftNo: 'M50-23', sentForRepair: '', expectedReturn: '', remarks: 'Due 04/12/2026' },
                { no: 14, epsSerial: '83235', initialCharge: '11.05.2015', status: 'unserviceable', aircraftNo: '', sentForRepair: '28/10/24', expectedReturn: '', remarks: 'U/S (AS/B/169/24) (AWD DMD 28/10/24)' },
                { no: 15, epsSerial: '83236', initialCharge: '15.04.2015', status: 'unserviceable', aircraftNo: '', sentForRepair: '11/08/25', expectedReturn: '', remarks: 'U/S (AS/B/075/25) (AWD DMD 11/08/25)' },
                { no: 16, epsSerial: '83241', initialCharge: '19.03.2015', status: 'serviceable', aircraftNo: 'M50-08', sentForRepair: '', expectedReturn: '', remarks: 'Due 22/12/2026' },
                { no: 17, epsSerial: '83244', initialCharge: '10.03.2015', status: 'serviceable', aircraftNo: 'M50-07', sentForRepair: '', expectedReturn: '', remarks: 'Due 19/02/2026' },
                { no: 18, epsSerial: '83411', initialCharge: '03.05.2016', status: 'serviceable', aircraftNo: 'M50-02', sentForRepair: '', expectedReturn: '', remarks: 'Due 08/07/2026' },
                { no: 19, epsSerial: '83413', initialCharge: '02.10.2017', status: 'unserviceable', aircraftNo: '', sentForRepair: '12/08/25', expectedReturn: '', remarks: 'U/S (AS/B/108/25) (AWD DMD 12/08/25)' },
                { no: 20, epsSerial: '83438', initialCharge: '28.04.2016', status: 'unserviceable', aircraftNo: '', sentForRepair: '12/08/25', expectedReturn: '', remarks: 'U/S (AS/B/100/25) (AWD DMD 12/08/25)' },
                { no: 21, epsSerial: '83515', initialCharge: '19.05.2016', status: 'serviceable', aircraftNo: 'M50-05', sentForRepair: '', expectedReturn: '', remarks: 'Due 11/01/2027' },
                { no: 22, epsSerial: '83526', initialCharge: '18.04.2024', status: 'serviceable', aircraftNo: 'M50-20', sentForRepair: '', expectedReturn: '', remarks: 'Due 15/12/2026' },
                { no: 23, epsSerial: '80992', initialCharge: '21.05.2024', status: 'serviceable', aircraftNo: 'M50-22', sentForRepair: '', expectedReturn: '', remarks: 'Due 25/03/2026' },
                { no: 24, epsSerial: '81001', initialCharge: '25.10.2019', status: 'serviceable', aircraftNo: 'M50-03', sentForRepair: '', expectedReturn: '', remarks: 'Due 05/03/2026' },
                { no: 25, epsSerial: '81326', initialCharge: '24.02.2020', status: 'unserviceable', aircraftNo: '', sentForRepair: '', expectedReturn: '', remarks: 'U/S (AS/B/004/26)' }
            ];

            useEffect(() => {
                loadData();
            }, []);

            const loadData = () => {
                try {
                    const stored = localStorage.getItem('eps-components-github');
                    if (stored) {
                        setComponents(JSON.parse(stored));
                    } else {
                        localStorage.setItem('eps-components-github', JSON.stringify(initialData));
                        setComponents(initialData);
                    }
                } catch (error) {
                    console.error('Error loading data:', error);
                    setComponents(initialData);
                }
                setLoading(false);
            };

            const openUpdateForm = (component) => {
                setSelectedComponent(component);
                setUpdateData({
                    status: component.status,
                    aircraftNo: component.aircraftNo || '',
                    sentForRepair: component.sentForRepair || '',
                    expectedReturn: component.expectedReturn || '',
                    remarks: component.remarks || ''
                });
                setShowUpdateForm(true);
            };

            const saveUpdate = () => {
                if (updateData.status === 'serviceable' && !updateData.aircraftNo) {
                    setNotification('⚠️ Please enter Aircraft No for serviceable components');
                    setTimeout(() => setNotification(''), 3000);
                    return;
                }

                if (updateData.status === 'unserviceable' && !updateData.sentForRepair) {
                    setNotification('⚠️ Please enter Sent for Repair date for unserviceable components');
                    setTimeout(() => setNotification(''), 3000);
                    return;
                }

                const updatedComponents = components.map(comp =>
                    comp.no === selectedComponent.no
                        ? {
                            ...comp,
                            status: updateData.status,
                            aircraftNo: updateData.status === 'serviceable' ? updateData.aircraftNo : '',
                            sentForRepair: updateData.status === 'unserviceable' ? updateData.sentForRepair : '',
                            expectedReturn: updateData.status === 'unserviceable' ? updateData.expectedReturn : '',
                            remarks: updateData.remarks,
                            lastUpdated: new Date().toLocaleString(),
                            updatedBy: 'Staff'
                        }
                        : comp
                );

                localStorage.setItem('eps-components-github', JSON.stringify(updatedComponents));
                setComponents(updatedComponents);
                setShowUpdateForm(false);
                setSelectedComponent(null);
                setNotification('✅ Component updated successfully!');
                setTimeout(() => setNotification(''), 3000);
            };

            const exportToCSV = () => {
                const headers = ['No', 'EPS Serial', 'Initial Charge', 'Status', 'Aircraft No', 'Sent for Repair', 'Expected Return', 'Remarks', 'Last Updated'];
                const rows = components.map(comp => [
                    comp.no,
                    comp.epsSerial,
                    comp.initialCharge,
                    comp.status.toUpperCase(),
                    comp.aircraftNo || '',
                    comp.sentForRepair || '',
                    comp.expectedReturn || '',
                    comp.remarks || '',
                    comp.lastUpdated || ''
                ]);

                const csv = [
                    headers.join(','),
                    ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
                ].join('\n');

                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `EPS-Status-${new Date().toISOString().split('T')[0]}.csv`;
                a.click();
                window.URL.revokeObjectURL(url);
            };

            const filteredComponents = components.filter(comp => {
                const matchesSearch = comp.epsSerial.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                     comp.aircraftNo.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesFilter = filter === 'all' || comp.status === filter;
                return matchesSearch && matchesFilter;
            });

            const stats = {
                total: components.length,
                serviceable: components.filter(c => c.status === 'serviceable').length,
                unserviceable: components.filter(c => c.status === 'unserviceable').length
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
                        <div className="text-lg text-gray-600">Loading...</div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
                            <div className="flex justify-between items-center mb-6">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-800 flex items-center gap-3">
                                        <Settings size={32} className="text-blue-600" />
                                        EPS Serviceability System
                                    </h1>
                                    <p className="text-gray-600 mt-1">Update component status quickly and easily</p>
                                </div>
                                <button
                                    onClick={exportToCSV}
                                    className="flex items-center gap-2 px-5 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition shadow-lg"
                                >
                                    <Download size={20} />
                                    Export to Excel
                                </button>
                            </div>

                            <div className="grid grid-cols-3 gap-4 mb-6">
                                <div className="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-5 rounded-xl shadow-lg">
                                    <div className="text-sm font-medium opacity-90">Total Components</div>
                                    <div className="text-4xl font-bold mt-2">{stats.total}</div>
                                </div>
                                <div className="bg-gradient-to-br from-green-500 to-green-600 text-white p-5 rounded-xl shadow-lg">
                                    <div className="text-sm font-medium opacity-90">Serviceable</div>
                                    <div className="text-4xl font-bold mt-2">{stats.serviceable}</div>
                                </div>
                                <div className="bg-gradient-to-br from-red-500 to-red-600 text-white p-5 rounded-xl shadow-lg">
                                    <div className="text-sm font-medium opacity-90">Unserviceable</div>
                                    <div className="text-4xl font-bold mt-2">{stats.unserviceable}</div>
                                </div>
                            </div>

                            <div className="flex gap-4">
                                <div className="flex-1 relative">
                                    <div className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400">
                                        <Search size={20} />
                                    </div>
                                    <input
                                        type="text"
                                        placeholder="Search by EPS Serial or Aircraft No..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.ta
