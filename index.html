<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPS Serviceability System</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; }
        .min-h-screen { min-height: 100vh; }
        .bg-gradient { background: linear-gradient(to bottom right, #eff6ff, #e0e7ff); }
        .container { max-width: 72rem; margin: 0 auto; padding: 1rem; }
        .card { background: white; border-radius: 1rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); padding: 1.5rem; }
        .card-lg { box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mt-1 { margin-top: 0.25rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-3 { margin-top: 0.75rem; }
        .mt-8 { margin-top: 2rem; }
        .p-4 { padding: 1rem; }
        .p-5 { padding: 1.25rem; }
        .p-8 { padding: 2rem; }
        .p-12 { padding: 3rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .px-5 { padding-left: 1.25rem; padding-right: 1.25rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .pl-3 { padding-left: 0.75rem; }
        .pl-12 { padding-left: 3rem; }
        .pr-4 { padding-right: 1rem; }
        .pt-2 { padding-top: 0.5rem; }
        .grid { display: grid; }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-xl { border-radius: 0.75rem; }
        .rounded-2xl { border-radius: 1rem; }
        .rounded-full { border-radius: 9999px; }
        .border-2 { border-width: 2px; }
        .border-l-4 { border-left-width: 4px; }
        .border-t { border-top-width: 1px; }
        .border-transparent { border-color: transparent; }
        .border-gray-200 { border-color: #e5e7eb; }
        .border-blue-300 { border-color: #93c5fd; }
        .border-blue-500 { border-color: #3b82f6; }
        .border-green-500 { border-color: #22c55e; }
        .border-red-500 { border-color: #ef4444; }
        .bg-white { background-color: white; }
        .bg-blue-50 { background-color: #eff6ff; }
        .bg-green-50 { background-color: #f0fdf4; }
        .bg-green-100 { background-color: #dcfce7; }
        .bg-red-50 { background-color: #fef2f2; }
        .bg-red-100 { background-color: #fee2e2; }
        .bg-orange-50 { background-color: #fff7ed; }
        .bg-gray-200 { background-color: #e5e7eb; }
        .bg-blue-600 { background-color: #2563eb; }
        .bg-green-600 { background-color: #16a34a; }
        .bg-gradient-blue { background: linear-gradient(to bottom right, #3b82f6, #2563eb); }
        .bg-gradient-green { background: linear-gradient(to bottom right, #22c55e, #16a34a); }
        .bg-gradient-red { background: linear-gradient(to bottom right, #ef4444, #dc2626); }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
        .text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .font-bold { font-weight: 700; }
        .text-white { color: white; }
        .text-gray-400 { color: #9ca3af; }
        .text-gray-500 { color: #6b7280; }
        .text-gray-600 { color: #4b5563; }
        .text-gray-700 { color: #374151; }
        .text-gray-800 { color: #1f2937; }
        .text-blue-600 { color: #2563eb; }
        .text-blue-700 { color: #1d4ed8; }
        .text-green-700 { color: #15803d; }
        .text-red-700 { color: #b91c1c; }
        .text-orange-700 { color: #c2410c; }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .shadow-xl { box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }
        .shadow-2xl { box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
        .opacity-90 { opacity: 0.9; }
        .cursor-pointer { cursor: pointer; }
        .transition { transition: all 0.15s ease-in-out; }
        .hover\:shadow-xl:hover { box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }
        .hover\:border-blue-300:hover { border-color: #93c5fd; }
        .hover\:border-green-300:hover { border-color: #86efac; }
        .hover\:bg-blue-700:hover { background-color: #1d4ed8; }
        .hover\:bg-green-700:hover { background-color: #15803d; }
        .hover\:bg-gray-300:hover { background-color: #d1d5db; }
        input, select, textarea { outline: none; }
        input:focus, select:focus, textarea:focus { 
            box-shadow: 0 0 0 2px #3b82f6; 
            border-color: #3b82f6; 
        }
        button { outline: none; cursor: pointer; border: none; }
        .relative { position: relative; }
        .absolute { position: absolute; }
        .fixed { position: fixed; }
        .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
        .left-4 { left: 1rem; }
        .top-1\/2 { top: 50%; }
        .transform { transform: translateY(-50%); }
        .z-50 { z-index: 50; }
        .bg-black { background-color: black; }
        .bg-opacity-50 { background-color: rgba(0,0,0,0.5); }
        .max-w-lg { max-width: 32rem; }
        .w-full { width: 100%; }
        .flex-1 { flex: 1; }
        .block { display: block; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .text-center { text-align: center; }
        .truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .max-w-xs { max-width: 20rem; }
        .space-y-2 > * + * { margin-top: 0.5rem; }
        .space-y-5 > * + * { margin-top: 1.25rem; }
        
        @media (min-width: 768px) {
            .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        }
        
        @media (min-width: 1024px) {
            .lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Search, AlertCircle, CheckCircle, Download, Settings, Plane } = lucide;

        function EPSUpdateSystem() {
            const [components, setComponents] = useState([]);
            const [loading, setLoading] = useState(true);
            const [searchTerm, setSearchTerm] = useState('');
            const [filter, setFilter] = useState('all');
            const [selectedComponent, setSelectedComponent] = useState(null);
            const [showUpdateForm, setShowUpdateForm] = useState(false);
            const [notification, setNotification] = useState('');
            const [updateData, setUpdateData] = useState({
                status: 'serviceable',
                aircraftNo: '',
                sentForRepair: '',
                expectedReturn: '',
                remarks: ''
            });

            const initialData = [
                { no: 1, epsSerial: '80379', initialCharge: '21.05.2024', status: 'unserviceable', aircraftNo: '', sentForRepair: '18/12/25', expectedReturn: '', remarks: 'U/S (AS/B/156/24) (AWD DMD 18/12/25)' },
                { no: 2, epsSerial: '80919', initialCharge: '17.09.2007', status: 'serviceable', aircraftNo: 'M50-21', sentForRepair: '', expectedReturn: '', remarks: 'Due 06/04/2026' },
                { no: 3, epsSerial: '80996', initialCharge: '20.10.2008', status: 'serviceable', aircraftNo: 'M50-16', sentForRepair: '', expectedReturn: '', remarks: 'Due 17/08/2026' },
                { no: 4, epsSerial: '81045', initialCharge: '24.05.2007', status: 'unserviceable', aircraftNo: '', sentForRepair: '28/10/24', expectedReturn: '', remarks: 'U/S (AS/B/171/24) (AWD DMD 28/10/24)' },
                { no: 5, epsSerial: '81046', initialCharge: '03.05.2008', status: 'serviceable', aircraftNo: 'M50-01', sentForRepair: '', expectedReturn: '', remarks: 'Due 11/11/2026' },
                { no: 6, epsSerial: '81262', initialCharge: '03.05.2024', status: 'unserviceable', aircraftNo: '', sentForRepair: '02/09/25', expectedReturn: '', remarks: 'U/S (AS/B/111/25) (AWD DMD 02/09/25)' },
                { no: 7, epsSerial: '81308', initialCharge: '12.09.2008', status: 'unserviceable', aircraftNo: '', sentForRepair: '13/06/25', expectedReturn: '', remarks: 'U/S (AS/B/055/25) (AWD DMD 13/06/25)' },
                { no: 8, epsSerial: '81322', initialCharge: '02.05.2014', status: 'unserviceable', aircraftNo: '', sentForRepair: '03/10/24', expectedReturn: '', remarks: 'Sent to Nilai (Loan) (15/08/25) (AS/B/164/24)' },
                { no: 9, epsSerial: '81688', initialCharge: '04.12.2008', status: 'unserviceable', aircraftNo: '', sentForRepair: '02/09/25', expectedReturn: '', remarks: 'U/S (AS/B/110/25) (AWD DMD 02/09/25)' },
                { no: 10, epsSerial: '81829', initialCharge: '08.08.2008', status: 'unserviceable', aircraftNo: '', sentForRepair: '02/09/25', expectedReturn: '', remarks: 'U/S (AS/B/112/25) (AWD DMD 02/09/25)' },
                { no: 11, epsSerial: '83204', initialCharge: '12.02.2015', status: 'unserviceable', aircraftNo: '', sentForRepair: '11/05/25', expectedReturn: '', remarks: 'U/S (AS/B/109/25) (AWD DMD 11/05/25)' },
                { no: 12, epsSerial: '83210', initialCharge: '03.05.2024', status: 'unserviceable', aircraftNo: '', sentForRepair: '24/11/25', expectedReturn: '', remarks: 'U/S (AS/B/148/25) (AWD DMD 24/11/25)' },
                { no: 13, epsSerial: '83218', initialCharge: '16.12.2015', status: 'serviceable', aircraftNo: 'M50-23', sentForRepair: '', expectedReturn: '', remarks: 'Due 04/12/2026' },
                { no: 14, epsSerial: '83235', initialCharge: '11.05.2015', status: 'unserviceable', aircraftNo: '', sentForRepair: '28/10/24', expectedReturn: '', remarks: 'U/S (AS/B/169/24) (AWD DMD 28/10/24)' },
                { no: 15, epsSerial: '83236', initialCharge: '15.04.2015', status: 'unserviceable', aircraftNo: '', sentForRepair: '11/08/25', expectedReturn: '', remarks: 'U/S (AS/B/075/25) (AWD DMD 11/08/25)' },
                { no: 16, epsSerial: '83241', initialCharge: '19.03.2015', status: 'serviceable', aircraftNo: 'M50-08', sentForRepair: '', expectedReturn: '', remarks: 'Due 22/12/2026' },
                { no: 17, epsSerial: '83244', initialCharge: '10.03.2015', status: 'serviceable', aircraftNo: 'M50-07', sentForRepair: '', expectedReturn: '', remarks: 'Due 19/02/2026' },
                { no: 18, epsSerial: '83411', initialCharge: '03.05.2016', status: 'serviceable', aircraftNo: 'M50-02', sentForRepair: '', expectedReturn: '', remarks: 'Due 08/07/2026' },
                { no: 19, epsSerial: '83413', initialCharge: '02.10.2017', status: 'unserviceable', aircraftNo: '', sentForRepair: '12/08/25', expectedReturn: '', remarks: 'U/S (AS/B/108/25) (AWD DMD 12/08/25)' },
                { no: 20, epsSerial: '83438', initialCharge: '28.04.2016', status: 'unserviceable', aircraftNo: '', sentForRepair: '12/08/25', expectedReturn: '', remarks: 'U/S (AS/B/100/25) (AWD DMD 12/08/25)' },
                { no: 21, epsSerial: '83515', initialCharge: '19.05.2016', status: 'serviceable', aircraftNo: 'M50-05', sentForRepair: '', expectedReturn: '', remarks: 'Due 11/01/2027' },
                { no: 22, epsSerial: '83526', initialCharge: '18.04.2024', status: 'serviceable', aircraftNo: 'M50-20', sentForRepair: '', expectedReturn: '', remarks: 'Due 15/12/2026' },
                { no: 23, epsSerial: '80992', initialCharge: '21.05.2024', status: 'serviceable', aircraftNo: 'M50-22', sentForRepair: '', expectedReturn: '', remarks: 'Due 25/03/2026' },
                { no: 24, epsSerial: '81001', initialCharge: '25.10.2019', status: 'serviceable', aircraftNo: 'M50-03', sentForRepair: '', expectedReturn: '', remarks: 'Due 05/03/2026' },
                { no: 25, epsSerial: '81326', initialCharge: '24.02.2020', status: 'unserviceable', aircraftNo: '', sentForRepair: '', expectedReturn: '', remarks: 'U/S (AS/B/004/26)' }
            ];

            useEffect(() => {
                loadData();
            }, []);

            const loadData = () => {
                const stored = localStorage.getItem('eps-components-github');
                if (stored) {
                    setComponents(JSON.parse(stored));
                } else {
                    localStorage.setItem('eps-components-github', JSON.stringify(initialData));
                    setComponents(initialData);
                }
                setLoading(false);
            };

            const openUpdateForm = (component) => {
                setSelectedComponent(component);
                setUpdateData({
                    status: component.status,
                    aircraftNo: component.aircraftNo || '',
                    sentForRepair: component.sentForRepair || '',
                    expectedReturn: component.expectedReturn || '',
                    remarks: component.remarks || ''
                });
                setShowUpdateForm(true);
            };

            const saveUpdate = () => {
                if (updateData.status === 'serviceable' && !updateData.aircraftNo) {
                    setNotification('⚠️ Please enter Aircraft No for serviceable components');
                    setTimeout(() => setNotification(''), 3000);
                    return;
                }

                if (updateData.status === 'unserviceable' && !updateData.sentForRepair) {
                    setNotification('⚠️ Please enter Sent for Repair date for unserviceable components');
                    setTimeout(() => setNotification(''), 3000);
                    return;
                }

                const updatedComponents = components.map(comp =>
                    comp.no === selectedComponent.no
                        ? {
                            ...comp,
                            status: updateData.status,
                            aircraftNo: updateData.status === 'serviceable' ? updateData.aircraftNo : '',
                            sentForRepair: updateData.status === 'unserviceable' ? updateData.sentForRepair : '',
                            expectedReturn: updateData.status === 'unserviceable' ? updateData.expectedReturn : '',
                            remarks: updateData.remarks,
                            lastUpdated: new Date().toLocaleString(),
                            updatedBy: 'Staff'
                        }
                        : comp
                );

                localStorage.setItem('eps-components-github', JSON.stringify(updatedComponents));
                setComponents(updatedComponents);
                setShowUpdateForm(false);
                setSelectedComponent(null);
                setNotification('✅ Component updated successfully!');
                setTimeout(() => setNotification(''), 3000);
            };

            const exportToCSV = () => {
                const headers = ['No', 'EPS Serial', 'Initial Charge', 'Status', 'Aircraft No', 'Sent for Repair', 'Expected Return', 'Remarks', 'Last Updated'];
                const rows = components.map(comp => [
                    comp.no,
                    comp.epsSerial,
                    comp.initialCharge,
                    comp.status.toUpperCase(),
                    comp.aircraftNo || '',
                    comp.sentForRepair || '',
                    comp.expectedReturn || '',
                    comp.remarks || '',
                    comp.lastUpdated || ''
                ]);

                const csv = [
                    headers.join(','),
                    ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
                ].join('\n');

                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `EPS-Status-${new Date().toISOString().split('T')[0]}.csv`;
                a.click();
                window.URL.revokeObjectURL(url);
            };

            const filteredComponents = components.filter(comp => {
                const matchesSearch = comp.epsSerial.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                     comp.aircraftNo.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesFilter = filter === 'all' || comp.status === filter;
                return matchesSearch && matchesFilter;
            });

            const stats = {
                total: components.length,
                serviceable: components.filter(c => c.status === 'serviceable').length,
                unserviceable: components.filter(c => c.status === 'unserviceable').length
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient flex items-center" style={{justifyContent:'center'}}>
                        <div className="text-lg text-gray-600">Loading...</div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient p-4">
                    <div className="container">
                        <div className="card card-lg mb-6">
                            <div className="flex justify-between items-center mb-6">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-800 flex items-center gap-3">
                                        <Settings className="text-blue-600" size={32} />
                                        EPS Serviceability System
                                    </h1>
                                    <p className="text-gray-600 mt-1">Update component status quickly and easily</p>
                                </div>
                                <button
                                    onClick={exportToCSV}
                                    className="flex items-center gap-2 px-5 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition shadow-lg"
                                >
                                    <Download size={20} />
                                    Export to Excel
                                </button>
                            </div>

                            <div className="grid grid-cols-3 gap-4 mb-6">
                                <div className="bg-gradient-blue text-white p-5 rounded-xl shadow-lg">
                                    <div className="text-sm font-medium opacity-90">Total Components</div>
                                    <div className="text-4xl font-bold mt-2">{stats.total}</div>
                                </div>
                                <div className="bg-gradient-green text-white p-5 rounded-xl shadow-lg">
                                    <div className="text-sm font-medium opacity-90">Serviceable</div>
                                    <div className="text-4xl font-bold mt-2">{stats.serviceable}</div>
                                </div>
                                <div className="bg-gradient-red text-white p-5 rounded-xl shadow-lg">
                                    <div className="text-sm font-medium opacity-90">Unserviceable</div>
                                    <div className="text-4xl font-bold mt-2">{stats.unserviceable}</div>
                                </div>
                            </div>

                            <div className="flex gap-4">
                                <div className="flex-1 relative">
                                    <Search className="absolute left-4 top-1/2 transform text-gray-400" size={20} />
                                    <input
                                        type="text"
                                        placeholder="Search by EPS Serial or Aircraft No..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                        className="w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl transition"
                                    />
                                </div>
                                <select
                                    value={filter}
                                    onChange={(e) => setFilter(e.target.value)}
                                    className="px-6 py-3 border-2 border-gray-200 rounded-xl transition font-medium"
                                >
                                    <option value="all">All Status</option>
                                    <option value="serviceable">✓ Serviceable</option>
                                    <option value="unserviceable">✗ Unserviceable</option>
                                </select>
                            </div>
                        </div>

                        {notification && (
                            <div className="mb-6 p-4 bg-white border-l-4 border-blue-500 rounded-lg shadow-lg text-gray-800 font-medium">
                                {notification}
                            </div>
                        )}

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            {filteredComponents.map((comp) => (
                                <div
                                    key={comp.no}
                                    className="card shadow-lg hover:shadow-xl transition p-5 cursor-pointer border-2 border-transparent hover:border-blue-300"
                                    onClick={() => openUpdateForm(comp)}
                                >
                                    <div className="flex justify-between items-start mb-3">
                                        <div>
                                            <div className="text-xs text-gray-500 font-medium">EPS SERIAL</div>
                                            <div className="text-2xl font-bold text-gray-800">{comp.epsSerial}</div>
                                        </div>
                                        <span className={`px-3 py-1 rounded-full text-xs font-bold ${
                                            comp.status === 'serviceable'
                                                ? 'bg-green-100 text-green-700'
                                                : 'bg-red-100 text-red-700'
                                        }`}>
                                            {comp.status === 'serviceable' ? '✓ SERVICEABLE' : '✗ U/S'}
                                        </span>
                                    </div>

                                    {comp.status === 'serviceable' ? (
                                        <div className="flex items-center gap-2 text-blue-700 bg-blue-50 px-3 py-2 rounded-lg">
                                            <Plane size={18} />
                                            <span className="font-semibold">{comp.aircraftNo || 'Not Assigned'}</span>
                                        </div>
                                    ) : (
                                        <div className="space-y-2">
                                            <div className="flex items-center gap-2 text-orange-700 bg-orange-50 px-3 py-2 rounded-lg text-sm">
                                                <AlertCircle size={16} />
                                                <span>Sent: {comp.sentForRepair || 'Not specified'}</span>
                                            </div>
                                            {comp.expectedReturn && (
                                                <div className="text-xs text-gray-600 pl-3">
                                                    Expected: {comp.expectedReturn}
                                                </div>
                                            )}
                                        </div>
                                    )}

                                    {comp.remarks && (
                                        <div className="mt-3 text-xs text-gray-600 border-t pt-2">
                                            {comp.remarks}
                                        </div>
                                    )}

                                    {comp.lastUpdated && (
                                        <div className="mt-2 text-xs text-
